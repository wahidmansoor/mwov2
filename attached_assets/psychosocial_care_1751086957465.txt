import {
  Dialog,
  DialogContent,
  DialogDescription,
  DialogHeader,
  DialogTitle,
} from "@/components/ui/dialog";
import {
  Accordion,
  AccordionContent,
  AccordionItem,
  AccordionTrigger,
} from "@/components/ui/accordion";
import { ScrollArea } from "@/components/ui/scroll-area";
import { Tabs, TabsContent, TabsList, TabsTrigger } from "@/components/ui/tabs";
import { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from "@/components/ui/table";
import { useState } from "react";

export function PsychosocialCareDialog() {
  const [isOpen, setIsOpen] = useState(false);
  const [activeTab, setActiveTab] = useState("communication");

  const communicationTechniques = [
    {
      technique: "PEARLS Model",
      description: "Framework for compassionate communication",
      components: [
        "Partnership: Collaborate with patient/family",
        "Empathy: Acknowledge emotions",
        "Apology: For delays or bad news",
        "Respect: Honor values and choices",
        "Legitimization: Validate concerns",
        "Support: Offer ongoing assistance"
      ]
    },
    {
      technique: "Open-Ended Questions",
      description: "Elicit patient perspectives and concerns",
      examples: [
        "What worries you most about your situation?",
        "How has this illness affected your daily life?",
        "What gives you strength during difficult times?",
        "What do you hope for in the time ahead?"
      ]
    },
    {
      technique: "Emotional Validation",
      description: "Acknowledge and normalize feelings",
      approaches: [
        "I can see this is really difficult for you",
        "It makes sense you'd feel that way",
        "Many people in your situation feel similarly",
        "Your feelings are completely understandable"
      ]
    }
  ];

  const interventions = [
    {
      category: "Psychological Support",
      approaches: [
        "Cognitive Behavioral Therapy (CBT) for anxiety/depression",
        "Dignity Therapy for meaning and legacy",
        "Supportive-expressive therapy for emotional processing",
        "Pharmacotherapy: SSRIs, psychostimulants, mirtazapine"
      ],
      screening: ["PHQ-9", "GAD-7", "Brief Grief Questionnaire"]
    },
    {
      category: "Social Support",
      approaches: [
        "Caregiver burden assessment and support",
        "Financial counseling and resource navigation",
        "Connection to community support groups",
        "Volunteer companionship programs"
      ],
      screening: ["Zarit Burden Interview", "Social Support Questionnaire"]
    }
  ];

  const stagesOfChange = [
    { stage: "Precontemplation", description: "Denial or lack of awareness", approach: "Gentle probing, offer follow-up" },
    { stage: "Contemplation", description: "Acknowledges concern", approach: "Discuss pros/cons, readiness scale" },
    { stage: "Preparation", description: "Planning change", approach: "Set realistic goals" },
    { stage: "Action", description: "Engaged in change", approach: "Reinforce behavior, manage obstacles" },
    { stage: "Maintenance", description: "Sustained change", approach: "Prevent relapse, affirm progress" },
    { stage: "Relapse", description: "Reverted behavior", approach: "Normalize experience, rebuild support" }
  ];

  const spiritualAssessment = {
    domains: [
      "Meaning and purpose",
      "Hope and despair",
      "Relationships and connection",
      "Forgiveness and reconciliation",
      "Transcendence and mystery"
    ],
    tools: ["FICA", "HOPE", "SPIRIT"],
    interventions: [
      "Chaplaincy services",
      "Life review and legacy work",
      "Rituals and sacraments",
      "Meditation and mindfulness",
      "Meaning-centered psychotherapy"
    ]
  };

  const specialPopulations = [
    {
      group: "Children",
      considerations: [
        "Tailor communication to developmental stage",
        "Use play, art, and music therapy",
        "Include parents in decision-making",
        "Address sibling concerns",
        "Provide age-appropriate information"
      ]
    },
    {
      group: "Older Adults",
      considerations: [
        "Assess for cognitive impairment",
        "Address social isolation",
        "Consider polypharmacy in treatment",
        "Respect life experience and wisdom",
        "Connect with community resources"
      ]
    },
    {
      group: "Cultural Considerations",
      considerations: [
        "Respect diverse attitudes toward illness/death",
        "Use professional interpreters (not family)",
        "Understand family decision-making structures",
        "Accommodate spiritual/religious practices",
        "Explore cultural meanings of suffering"
      ]
    }
  ];

  return (
    <Dialog open={isOpen} onOpenChange={setIsOpen}>
      <DialogContent className="max-w-5xl h-[90vh]">
        <DialogHeader>
          <DialogTitle>Psychosocial Care in Palliative Care</DialogTitle>
          <DialogDescription>
            Addressing emotional, psychological, social, and spiritual dimensions of care
          </DialogDescription>
        </DialogHeader>

        <Tabs value={activeTab} onValueChange={setActiveTab} className="mt-4">
          <TabsList className="grid w-full grid-cols-4 gap-2">
            <TabsTrigger value="communication">Communication</TabsTrigger>
            <TabsTrigger value="interventions">Interventions</TabsTrigger>
            <TabsTrigger value="behavior">Behavioral Change</TabsTrigger>
            <TabsTrigger value="spiritual">Spiritual Care</TabsTrigger>
            <TabsTrigger value="special">Special Populations</TabsTrigger>
          </TabsList>

          <ScrollArea className="h-[70vh] p-4">
            <TabsContent value="communication">
              <h3 className="text-lg font-semibold mb-4">Communication Techniques</h3>
              
              <div className="space-y-6">
                {communicationTechniques.map((technique, index) => (
                  <div key={index} className="border rounded-lg p-4">
                    <h4 className="font-medium text-lg">{technique.technique}</h4>
                    <p className="text-muted-foreground">{technique.description}</p>
                    
                    <div className="mt-4">
                      {technique.components && (
                        <>
                          <p className="font-medium mb-2">Components:</p>
                          <ul className="list-disc pl-5 space-y-1">
                            {technique.components.map((component, i) => (
                              <li key={i}>{component}</li>
                            ))}
                          </ul>
                        </>
                      )}
                      
                      {technique.examples && (
                        <>
                          <p className="font-medium mb-2 mt-3">Examples:</p>
                          <ul className="list-disc pl-5 space-y-1">
                            {technique.examples.map((example, i) => (
                              <li key={i} className="italic">"{example}"</li>
                            ))}
                          </ul>
                        </>
                      )}
                      
                      {technique.approaches && (
                        <>
                          <p className="font-medium mb-2 mt-3">Approaches:</p>
                          <ul className="list-disc pl-5 space-y-1">
                            {technique.approaches.map((approach, i) => (
                              <li key={i}>{approach}</li>
                            ))}
                          </ul>
                        </>
                      )}
                    </div>
                  </div>
                ))}
                
                <div className="mt-6 p-4 bg-blue-50 rounded-lg">
                  <h4 className="font-medium mb-2">Communication Principles:</h4>
                  <ul className="list-disc pl-5 space-y-1">
                    <li>Assess readiness before sharing difficult information</li>
                    <li>Avoid false reassurance; acknowledge uncertainty</li>
                    <li>Provide realistic hope focused on comfort and dignity</li>
                    <li>Use trained medical interpreters for language barriers</li>
                    <li>Confirm understanding with teach-back method</li>
                  </ul>
                </div>
              </div>
            </TabsContent>

            <TabsContent value="interventions">
              <h3 className="text-lg font-semibold mb-4">Psychosocial Interventions</h3>
              
              <div className="grid grid-cols-2 gap-6">
                {interventions.map((intervention, index) => (
                  <div key={index} className="border rounded-lg p-4">
                    <h4 className="font-medium text-lg">{intervention.category}</h4>
                    
                    <div className="mt-4">
                      <p className="font-medium mb-2">Therapeutic Approaches:</p>
                      <ul className="list-disc pl-5 space-y-1">
                        {intervention.approaches.map((approach, i) => (
                          <li key={i}>{approach}</li>
                        ))}
                      </ul>
                    </div>
                    
                    <div className="mt-4">
                      <p className="font-medium mb-2">Screening Tools:</p>
                      <div className="flex flex-wrap gap-2">
                        {intervention.screening.map((tool, i) => (
                          <span key={i} className="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm">
                            {tool}
                          </span>
                        ))}
                      </div>
                    </div>
                  </div>
                ))}
              </div>
              
              <div className="mt-8">
                <h4 className="font-medium mb-2">Pharmacological Options:</h4>
                <div className="grid grid-cols-3 gap-4">
                  <div className="border p-4 rounded-lg">
                    <p className="font-medium">SSRIs</p>
                    <p className="text-sm mt-1">Sertraline (25-50 mg/day), Fluoxetine (20 mg/day)</p>
                    <p className="text-xs text-muted-foreground mt-1">For depression and anxiety</p>
                  </div>
                  <div className="border p-4 rounded-lg">
                    <p className="font-medium">Mirtazapine</p>
                    <p className="text-sm mt-1">15-30 mg at bedtime</p>
                    <p className="text-xs text-muted-foreground mt-1">For depression with insomnia/poor appetite</p>
                  </div>
                  <div className="border p-4 rounded-lg">
                    <p className="font-medium">Psychostimulants</p>
                    <p className="text-sm mt-1">Methylphenidate 5-10 mg morning/noon</p>
                    <p className="text-xs text-muted-foreground mt-1">For rapid effect in limited prognosis</p>
                  </div>
                </div>
              </div>
            </TabsContent>

            <TabsContent value="behavior">
              <h3 className="text-lg font-semibold mb-4">Behavioral Change Support</h3>
              
              <div className="grid grid-cols-2 gap-6">
                <div>
                  <h4 className="font-medium mb-2">Motivational Interviewing</h4>
                  <div className="border p-4 rounded-lg">
                    <ul className="list-disc pl-5 space-y-2">
                      <li>Express empathy through reflective listening</li>
                      <li>Develop discrepancy between current behavior and goals</li>
                      <li>Roll with resistance rather than opposing it</li>
                      <li>Support self-efficacy and optimism</li>
                      <li>Use readiness-to-change scaling questions</li>
                    </ul>
                    
                    <div className="mt-4 p-3 bg-yellow-50 rounded">
                      <p className="font-medium">Example Question:</p>
                      <p className="italic">"On a scale from 1 to 10, how ready are you to discuss hospice care, and why did you choose that number?"</p>
                    </div>
                  </div>
                </div>
                
                <div>
                  <h4 className="font-medium mb-2">Stages of Change Model</h4>
                  <div className="border rounded-lg overflow-hidden">
                    <Table>
                      <TableHeader>
                        <TableRow>
                          <TableHead>Stage</TableHead>
                          <TableHead>Description</TableHead>
                          <TableHead>Approach</TableHead>
                        </TableRow>
                      </TableHeader>
                      <TableBody>
                        {stagesOfChange.map((stage, index) => (
                          <TableRow key={index}>
                            <TableCell className="font-medium">{stage.stage}</TableCell>
                            <TableCell>{stage.description}</TableCell>
                            <TableCell>{stage.approach}</TableCell>
                          </TableRow>
                        ))}
                      </TableBody>
                    </Table>
                  </div>
                </div>
              </div>
              
              <div className="mt-6 p-4 bg-green-50 rounded-lg">
                <h4 className="font-medium mb-2">Goal-Setting Strategies:</h4>
                <ul className="list-disc pl-5 space-y-1">
                  <li>Collaboratively define achievable short-term goals</li>
                  <li>Align goals with patient values and priorities</li>
                  <li>Break larger goals into manageable steps</li>
                  <li>Celebrate small successes along the way</li>
                  <li>Regularly reassess and adjust goals as needed</li>
                </ul>
              </div>
            </TabsContent>

            <TabsContent value="spiritual">
              <h3 className="text-lg font-semibold mb-4">Spiritual and Existential Care</h3>
              
              <div className="grid grid-cols-2 gap-6">
                <div>
                  <h4 className="font-medium mb-2">Spiritual Assessment Domains</h4>
                  <ul className="list-disc pl-5 space-y-2">
                    {spiritualAssessment.domains.map((domain, index) => (
                      <li key={index}>{domain}</li>
                    ))}
                  </ul>
                  
                  <div className="mt-4">
                    <h4 className="font-medium mb-2">Assessment Tools:</h4>
                    <div className="flex flex-wrap gap-2">
                      {spiritualAssessment.tools.map((tool, i) => (
                        <span key={i} className="bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm">
                          {tool}
                        </span>
                      ))}
                    </div>
                  </div>
                </div>
                
                <div>
                  <h4 className="font-medium mb-2">Spiritual Interventions</h4>
                  <ul className="list-disc pl-5 space-y-2">
                    {spiritualAssessment.interventions.map((intervention, index) => (
                      <li key={index}>{intervention}</li>
                    ))}
                  </ul>
                  
                  <div className="mt-4 p-3 bg-purple-50 rounded">
                    <p className="font-medium">Key Considerations:</p>
                    <ul className="list-disc pl-5 mt-1 space-y-1">
                      <li>Spiritual concerns often intensify near end of life</li>
                      <li>Existential distress may manifest as physical symptoms</li>
                      <li>Spiritual beliefs significantly impact medical decisions</li>
                      <li>Chaplains are essential interdisciplinary team members</li>
                    </ul>
                  </div>
                </div>
              </div>
              
              <div className="mt-6">
                <h4 className="font-medium mb-2">Sample Spiritual Questions:</h4>
                <div className="grid grid-cols-3 gap-4">
                  <div className="border p-3 rounded">
                    <p className="italic">"What gives your life meaning?"</p>
                  </div>
                  <div className="border p-3 rounded">
                    <p className="italic">"How has your illness affected your spiritual beliefs?"</p>
                  </div>
                  <div className="border p-3 rounded">
                    <p className="italic">"What spiritual practices are important to you?"</p>
                  </div>
                </div>
              </div>
            </TabsContent>

            <TabsContent value="special">
              <h3 className="text-lg font-semibold mb-4">Special Populations</h3>
              
              <div className="grid grid-cols-3 gap-4">
                {specialPopulations.map((population, index) => (
                  <div key={index} className="border rounded-lg p-4">
                    <h4 className="font-medium text-lg">{population.group}</h4>
                    
                    <ul className="list-disc pl-5 mt-3 space-y-1">
                      {population.considerations.map((consideration, i) => (
                        <li key={i}>{consideration}</li>
                      ))}
                    </ul>
                    
                    {population.group === "Children" && (
                      <div className="mt-3 p-2 bg-blue-50 rounded">
                        <p className="text-xs font-medium">Communication Tips:</p>
                        <p className="text-xs">Use clear, concrete language; avoid euphemisms; encourage expression through play</p>
                      </div>
                    )}
                    
                    {population.group === "Cultural Considerations" && (
                      <div className="mt-3 p-2 bg-green-50 rounded">
                        <p className="text-xs font-medium">Ethical Principle:</p>
                        <p className="text-xs">Respect cultural preferences while ensuring informed consent</p>
                      </div>
                    )}
                  </div>
                ))}
              </div>
              
              <div className="mt-6">
                <h4 className="font-medium mb-2">Family Support Approaches:</h4>
                <div className="grid grid-cols-3 gap-4">
                  <div className="border p-4 rounded-lg">
                    <p className="font-medium">Caregiver Support</p>
                    <ul className="list-disc pl-5 mt-1 text-sm space-y-1">
                      <li>Respite care services</li>
                      <li>Caregiver skills training</li>
                      <li>Support groups</li>
                    </ul>
                  </div>
                  <div className="border p-4 rounded-lg">
                    <p className="font-medium">Bereavement Care</p>
                    <ul className="list-disc pl-5 mt-1 text-sm space-y-1">
                      <li>Grief counseling</li>
                      <li>Memorial services</li>
                      <li>Follow-up support</li>
                    </ul>
                  </div>
                  <div className="border p-4 rounded-lg">
                    <p className="font-medium">Ethical Guidance</p>
                    <ul className="list-disc pl-5 mt-1 text-sm space-y-1">
                      <li>Advance care planning</li>
                      <li>Conflict mediation</li>
                      <li>Ethics consultations</li>
                    </ul>
                  </div>
                </div>
              </div>
            </TabsContent>
          </ScrollArea>
        </Tabs>
      </DialogContent>
    </Dialog>
  );
}