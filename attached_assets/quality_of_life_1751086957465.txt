import {
  Dialog,
  DialogContent,
  DialogDescription,
  DialogHeader,
  DialogTitle,
} from "@/components/ui/dialog";
import {
  Accordion,
  AccordionContent,
  AccordionItem,
  AccordionTrigger,
} from "@/components/ui/accordion";
import { ScrollArea } from "@/components/ui/scroll-area";
import { Tabs, TabsContent, TabsList, TabsTrigger } from "@/components/ui/tabs";
import { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from "@/components/ui/table";
import { useState } from "react";

export function QualityOfLifeDialog() {
  const [isOpen, setIsOpen] = useState(false);
  const [activeTab, setActiveTab] = useState("dimensions");

  const qolDimensions = [
    {
      name: "Physical Domain",
      description: "Management of physical symptoms",
      symptoms: ["Pain", "Dyspnea", "Fatigue", "Nausea", "Anorexia", "Insomnia", "Constipation"],
      interventions: [
        "Individualized symptom relief protocols",
        "WHO analgesic ladder for pain management",
        "Low-dose opioids for dyspnea",
        "Prophylactic laxatives for constipation"
      ]
    },
    {
      name: "Psychological Domain",
      description: "Addressing emotional and mental health",
      symptoms: ["Depression", "Anxiety", "Demoralization", "Anticipatory grief"],
      interventions: [
        "Psychotherapy (CBT, dignity therapy)",
        "SSRIs (e.g., sertraline 25-50 mg/day)",
        "Mirtazapine for appetite/sleep issues",
        "Psychostimulants for rapid effect"
      ]
    },
    {
      name: "Social Domain",
      description: "Addressing relationships and support systems",
      symptoms: ["Family conflicts", "Caregiver burden", "Social isolation", "Financial strain"],
      interventions: [
        "Family meetings and mediation",
        "Caregiver support programs",
        "Social services navigation",
        "Peer support groups"
      ]
    },
    {
      name: "Functional Domain",
      description: "Maintaining independence and capabilities",
      symptoms: ["Mobility limitations", "ADL dependence", "Reduced independence"],
      interventions: [
        "Occupational/physical therapy",
        "Adaptive devices and home modifications",
        "Energy conservation techniques",
        "Realistic goal-setting"
      ]
    },
    {
      name: "Spiritual Domain",
      description: "Addressing existential concerns and meaning",
      symptoms: ["Loss of purpose", "Existential distress", "Spiritual crisis", "Hopelessness"],
      interventions: [
        "Chaplaincy services",
        "Dignity therapy and life review",
        "Meaning-centered psychotherapy",
        "Rituals aligned with beliefs"
      ]
    }
  ];

  const assessmentTools = [
    { tool: "Numeric Rating Scale (NRS)", purpose: "Symptom intensity (0-10)", notes: "For pain, breathlessness, nausea" },
    { tool: "Visual Analog Scale (VAS)", purpose: "Subjective QoL measure", notes: "0-100 scale; tracks change over time" },
    { tool: "Palliative Performance Scale (PPS)", purpose: "Functional capacity", notes: "Guides hospice eligibility" },
    { tool: "Karnofsky Performance Scale", purpose: "Independence/function", notes: "0-100 scale; predicts prognosis" },
    { tool: "ECOG Performance Status", purpose: "Ambulatory status", notes: "Common in oncology" },
    { tool: "FACIT-Pal/EORTC QLQ-C30", purpose: "Multidimensional QoL", notes: "Research and longitudinal tracking" },
    { tool: "IPOS", purpose: "Symptom, psychosocial needs", notes: "Clinically validated for palliative care" }
  ];

  const interdisciplinaryTeam = [
    { role: "Physician", responsibilities: "Symptom management, goals of care" },
    { role: "Nurse", responsibilities: "Monitoring, comfort measures, education" },
    { role: "Social Worker", responsibilities: "Resource coordination, counseling" },
    { role: "Chaplain", responsibilities: "Spiritual support, existential counseling" },
    { role: "Psychologist/Psychiatrist", responsibilities: "Mental health assessment and care" },
    { role: "Physical Therapist", responsibilities: "Mobility preservation, adaptive strategies" },
    { role: "Occupational Therapist", responsibilities: "ADL support, environmental adaptations" }
  ];

  const communicationFrameworks = [
    {
      name: "Ask-Tell-Ask",
      steps: [
        "Ask permission to discuss difficult topics",
        "Tell information in clear, compassionate terms",
        "Ask what was understood and address concerns"
      ]
    },
    {
      name: "SPIKES Protocol",
      steps: [
        "Setting: Private environment",
        "Perception: Assess patient understanding",
        "Invitation: Ask how much information is desired",
        "Knowledge: Deliver information clearly",
        "Emotions: Acknowledge and respond to emotions",
        "Strategy/Summary: Develop care plan together"
      ]
    }
  ];

  return (
    <Dialog open={isOpen} onOpenChange={setIsOpen}>
      <DialogContent className="max-w-5xl h-[90vh]">
        <DialogHeader>
          <DialogTitle>Quality of Life in Palliative Care</DialogTitle>
          <DialogDescription>
            Holistic assessment and comprehensive improvement strategies
          </DialogDescription>
        </DialogHeader>

        <Tabs value={activeTab} onValueChange={setActiveTab} className="mt-4">
          <TabsList className="grid w-full grid-cols-4 gap-2">
            <TabsTrigger value="dimensions">Dimensions</TabsTrigger>
            <TabsTrigger value="assessment">Assessment Tools</TabsTrigger>
            <TabsTrigger value="team">Interdisciplinary Team</TabsTrigger>
            <TabsTrigger value="strategies">Improvement Strategies</TabsTrigger>
          </TabsList>

          <ScrollArea className="h-[70vh] p-4">
            <TabsContent value="dimensions">
              <h3 className="text-lg font-semibold mb-4">Holistic Dimensions of Quality of Life</h3>
              
              <Accordion type="multiple" className="w-full">
                {qolDimensions.map((dimension, index) => (
                  <AccordionItem key={index} value={`dimension-${index}`}>
                    <AccordionTrigger className="text-left">
                      <div>
                        <p className="font-medium">{dimension.name}</p>
                        <p className="text-sm text-muted-foreground font-normal">{dimension.description}</p>
                      </div>
                    </AccordionTrigger>
                    <AccordionContent>
                      <div className="grid grid-cols-2 gap-4 p-4">
                        <div>
                          <h4 className="font-medium mb-2">Common Symptoms/Challenges:</h4>
                          <ul className="list-disc pl-5 space-y-1">
                            {dimension.symptoms.map((symptom, i) => (
                              <li key={i}>{symptom}</li>
                            ))}
                          </ul>
                        </div>
                        <div>
                          <h4 className="font-medium mb-2">Interventions:</h4>
                          <ul className="list-disc pl-5 space-y-1">
                            {dimension.interventions.map((intervention, i) => (
                              <li key={i}>{intervention}</li>
                            ))}
                          </ul>
                        </div>
                      </div>
                    </AccordionContent>
                  </AccordionItem>
                ))}
              </Accordion>
            </TabsContent>

            <TabsContent value="assessment">
              <h3 className="text-lg font-semibold mb-4">Quality of Life Assessment Tools</h3>
              
              <div className="border rounded-lg overflow-hidden">
                <Table>
                  <TableHeader>
                    <TableRow>
                      <TableHead>Assessment Tool</TableHead>
                      <TableHead>Purpose</TableHead>
                      <TableHead>Notes</TableHead>
                    </TableRow>
                  </TableHeader>
                  <TableBody>
                    {assessmentTools.map((tool, index) => (
                      <TableRow key={index}>
                        <TableCell className="font-medium">{tool.tool}</TableCell>
                        <TableCell>{tool.purpose}</TableCell>
                        <TableCell>{tool.notes}</TableCell>
                      </TableRow>
                    ))}
                  </TableBody>
                </Table>
              </div>

              <div className="mt-6">
                <h4 className="font-medium mb-2">Implementation Guidelines:</h4>
                <ul className="list-disc pl-5 space-y-2">
                  <li>Integrate into routine clinical visits</li>
                  <li>Reassess every 1-3 months or with clinical changes</li>
                  <li>Use scores to guide treatment intensification</li>
                  <li>Track trends over time rather than single measurements</li>
                </ul>
              </div>
            </TabsContent>

            <TabsContent value="team">
              <h3 className="text-lg font-semibold mb-4">Interdisciplinary Team Approach</h3>
              
              <div className="border rounded-lg overflow-hidden mb-6">
                <Table>
                  <TableHeader>
                    <TableRow>
                      <TableHead>Team Member</TableHead>
                      <TableHead>Key Responsibilities</TableHead>
                    </TableRow>
                  </TableHeader>
                  <TableBody>
                    {interdisciplinaryTeam.map((member, index) => (
                      <TableRow key={index}>
                        <TableCell className="font-medium">{member.role}</TableCell>
                        <TableCell>{member.responsibilities}</TableCell>
                      </TableRow>
                    ))}
                  </TableBody>
                </Table>
              </div>

              <div className="grid grid-cols-2 gap-4">
                <div>
                  <h4 className="font-medium mb-2">Communication Frameworks:</h4>
                  <div className="space-y-4">
                    {communicationFrameworks.map((framework, index) => (
                      <div key={index} className="border p-4 rounded-lg">
                        <p className="font-medium">{framework.name}</p>
                        <ol className="list-decimal pl-5 mt-2 space-y-1">
                          {framework.steps.map((step, i) => (
                            <li key={i} className="text-sm">{step}</li>
                          ))}
                        </ol>
                      </div>
                    ))}
                  </div>
                </div>

                <div>
                  <h4 className="font-medium mb-2">Team Coordination:</h4>
                  <ul className="list-disc pl-5 space-y-2">
                    <li>Weekly interdisciplinary team meetings</li>
                    <li>Shared electronic health records</li>
                    <li>Regular case conferences for complex patients</li>
                    <li>Unified care plans accessible to all team members</li>
                    <li>Defined roles with overlapping competencies</li>
                  </ul>
                </div>
              </div>
            </TabsContent>

            <TabsContent value="strategies">
              <h3 className="text-lg font-semibold mb-4">Quality of Life Improvement Strategies</h3>
              
              <div className="space-y-6">
                <div>
                  <h4 className="font-medium mb-2">Symptom-Specific Protocols:</h4>
                  <div className="grid grid-cols-3 gap-4">
                    <div className="border p-4 rounded-lg">
                      <p className="font-medium">Pain Management</p>
                      <p className="text-sm mt-1">WHO analgesic ladder with regular reassessment</p>
                    </div>
                    <div className="border p-4 rounded-lg">
                      <p className="font-medium">Dyspnea Relief</p>
                      <p className="text-sm mt-1">Low-dose opioids, fan therapy, positioning</p>
                    </div>
                    <div className="border p-4 rounded-lg">
                      <p className="font-medium">Nausea Control</p>
                      <p className="text-sm mt-1">Cause-specific antiemetics (metoclopramide, haloperidol)</p>
                    </div>
                  </div>
                </div>

                <div>
                  <h4 className="font-medium mb-2">Psychological Support Approaches:</h4>
                  <div className="grid grid-cols-2 gap-4">
                    <div className="border p-4 rounded-lg">
                      <p className="font-medium">Dignity Therapy</p>
                      <p className="text-sm mt-1">Structured life review to affirm meaning and legacy</p>
                    </div>
                    <div className="border p-4 rounded-lg">
                      <p className="font-medium">Meaning-Centered Psychotherapy</p>
                      <p className="text-sm mt-1">Exploration of sources of meaning in life</p>
                    </div>
                  </div>
                </div>

                <div>
                  <h4 className="font-medium mb-2">Functional Preservation Techniques:</h4>
                  <ul className="list-disc pl-5 space-y-2">
                    <li>Energy conservation education</li>
                    <li>Home safety assessments</li>
                    <li>Assistive device prescriptions (walkers, grab bars)</li>
                    <li>Activity pacing strategies</li>
                  </ul>
                </div>

                <div>
                  <h4 className="font-medium mb-2">Cultural Considerations:</h4>
                  <div className="grid grid-cols-3 gap-4">
                    <div className="border p-3 rounded">
                      <p className="font-medium text-sm">Decision-Making</p>
                      <p className="text-sm mt-1">Respect family-centered vs individual autonomy models</p>
                    </div>
                    <div className="border p-3 rounded">
                      <p className="font-medium text-sm">Symptom Expression</p>
                      <p className="text-sm mt-1">Understand cultural variations in symptom reporting</p>
                    </div>
                    <div className="border p-3 rounded">
                      <p className="font-medium text-sm">Spiritual Practices</p>
                      <p className="text-sm mt-1">Accommodate rituals and observances</p>
                    </div>
                  </div>
                </div>
              </div>
            </TabsContent>
          </ScrollArea>
        </Tabs>
      </DialogContent>
    </Dialog>
  );
}